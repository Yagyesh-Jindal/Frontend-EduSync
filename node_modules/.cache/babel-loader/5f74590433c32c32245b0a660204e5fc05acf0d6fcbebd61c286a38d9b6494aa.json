{"ast":null,"code":"\"use client\";import{useState,useEffect}from\"react\";import{Container,Row,Col,Card,Button,Form,InputGroup}from\"react-bootstrap\";import{Link}from\"react-router-dom\";import{courseService}from\"../services/api\";import{useAuth}from\"../contexts/AuthContext\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const CoursesPage=()=>{const[courses,setCourses]=useState([]);const[filteredCourses,setFilteredCourses]=useState([]);const[searchTerm,setSearchTerm]=useState(\"\");const[loading,setLoading]=useState(true);const{user}=useAuth();useEffect(()=>{fetchCourses();},[]);useEffect(()=>{// Filter courses based on search term\nconst filtered=courses.filter(course=>course.title.toLowerCase().includes(searchTerm.toLowerCase())||course.description.toLowerCase().includes(searchTerm.toLowerCase()));setFilteredCourses(filtered);},[courses,searchTerm]);const fetchCourses=async()=>{try{const response=await courseService.getAllCourses();setCourses(response.data);setFilteredCourses(response.data);}catch(error){console.error(\"Error fetching courses:\",error);}finally{setLoading(false);}};const handleEnroll=async courseId=>{try{console.log(\"Attempting to enroll in course:\",courseId);const response=await courseService.enrollInCourse(courseId);console.log(\"Enrollment successful:\",response);// Refresh courses to update enrollment status\nfetchCourses();}catch(error){var _error$response,_error$response2;console.error(\"Error enrolling in course:\",error);console.error(\"Error details:\",(_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.data);// Show error to user\nalert(\"Failed to enroll: \".concat(((_error$response2=error.response)===null||_error$response2===void 0?void 0:_error$response2.data)||error.message||\"Unknown error\"));}};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\",children:/*#__PURE__*/_jsx(\"div\",{className:\"spinner-border text-primary\",role:\"status\",children:/*#__PURE__*/_jsx(\"span\",{className:\"visually-hidden\",children:\"Loading courses...\"})})});}return/*#__PURE__*/_jsxs(Container,{className:\"py-5\",children:[/*#__PURE__*/_jsx(Row,{className:\"mb-4\",children:/*#__PURE__*/_jsxs(Col,{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"display-4 fw-bold text-center mb-4\",children:\"All Courses\"}),/*#__PURE__*/_jsx(\"p\",{className:\"lead text-center text-muted mb-4\",children:\"Discover and enroll in courses that match your interests\"}),/*#__PURE__*/_jsx(Row,{className:\"justify-content-center\",children:/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(InputGroup,{className:\"mb-4\",children:[/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"Search courses...\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value)}),/*#__PURE__*/_jsx(Button,{variant:\"outline-primary\",children:/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-search\"})})]})})})]})}),/*#__PURE__*/_jsx(Row,{children:filteredCourses.length===0?/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(Card,{className:\"text-center py-5\",children:/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(\"h5\",{children:\"No Courses Found\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted\",children:searchTerm?\"Try adjusting your search terms.\":\"No courses are available at the moment.\"})]})})}):filteredCourses.map(course=>/*#__PURE__*/_jsx(Col,{md:6,lg:4,className:\"mb-4\",children:/*#__PURE__*/_jsxs(Card,{className:\"course-card h-100\",children:[course.mediaUrl?/*#__PURE__*/_jsx(Card.Img,{variant:\"top\",src:course.mediaUrl,style:{height:\"200px\",objectFit:\"cover\"}}):/*#__PURE__*/_jsx(\"div\",{className:\"card-img-top course-gradient-bg\",children:course.title}),/*#__PURE__*/_jsxs(Card.Body,{className:\"d-flex flex-column\",children:[/*#__PURE__*/_jsx(Card.Title,{children:course.title}),/*#__PURE__*/_jsx(Card.Text,{className:\"flex-grow-1\",children:course.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center mb-2\",children:[/*#__PURE__*/_jsxs(\"small\",{className:\"text-muted\",children:[\"Instructor: \",course.instructorName||\"TBA\"]}),/*#__PURE__*/_jsxs(\"small\",{className:\"text-muted\",children:[course.enrolledStudents||0,\" students\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex gap-2\",children:[/*#__PURE__*/_jsx(Link,{to:\"/course/\".concat(course.courseId),children:/*#__PURE__*/_jsx(Button,{variant:\"outline-primary\",size:\"sm\",children:\"View Details\"})}),user&&user.role===\"Student\"&&/*#__PURE__*/_jsx(Button,{variant:\"primary\",size:\"sm\",onClick:()=>handleEnroll(course.courseId),disabled:course.isEnrolled,children:course.isEnrolled?\"Enrolled\":\"Enroll Now\"})]})]})]})]})},course.courseId))})]});};export default CoursesPage;","map":{"version":3,"names":["useState","useEffect","Container","Row","Col","Card","Button","Form","InputGroup","Link","courseService","useAuth","jsx","_jsx","jsxs","_jsxs","CoursesPage","courses","setCourses","filteredCourses","setFilteredCourses","searchTerm","setSearchTerm","loading","setLoading","user","fetchCourses","filtered","filter","course","title","toLowerCase","includes","description","response","getAllCourses","data","error","console","handleEnroll","courseId","log","enrollInCourse","_error$response","_error$response2","alert","concat","message","className","children","role","md","Control","type","placeholder","value","onChange","e","target","variant","length","Body","map","lg","mediaUrl","Img","src","style","height","objectFit","Title","Text","instructorName","enrolledStudents","to","size","onClick","disabled","isEnrolled"],"sources":["E:/project-capg/frontend/src/pages/CoursesPage.js"],"sourcesContent":["\"use client\"\n\nimport { useState, useEffect } from \"react\"\nimport { Container, Row, Col, Card, Button, Form, InputGroup } from \"react-bootstrap\"\nimport { Link } from \"react-router-dom\"\nimport { courseService } from \"../services/api\"\nimport { useAuth } from \"../contexts/AuthContext\"\n\nconst CoursesPage = () => {\n  const [courses, setCourses] = useState([])\n  const [filteredCourses, setFilteredCourses] = useState([])\n  const [searchTerm, setSearchTerm] = useState(\"\")\n  const [loading, setLoading] = useState(true)\n  const { user } = useAuth()\n\n  useEffect(() => {\n    fetchCourses()\n  }, [])\n\n  useEffect(() => {\n    // Filter courses based on search term\n    const filtered = courses.filter(\n      (course) =>\n        course.title.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        course.description.toLowerCase().includes(searchTerm.toLowerCase()),\n    )\n    setFilteredCourses(filtered)\n  }, [courses, searchTerm])\n\n  const fetchCourses = async () => {\n    try {\n      const response = await courseService.getAllCourses()\n      setCourses(response.data)\n      setFilteredCourses(response.data)\n    } catch (error) {\n      console.error(\"Error fetching courses:\", error)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleEnroll = async (courseId) => {\n    try {\n      console.log(\"Attempting to enroll in course:\", courseId);\n      const response = await courseService.enrollInCourse(courseId);\n      console.log(\"Enrollment successful:\", response);\n      // Refresh courses to update enrollment status\n      fetchCourses();\n    } catch (error) {\n      console.error(\"Error enrolling in course:\", error);\n      console.error(\"Error details:\", error.response?.data);\n      // Show error to user\n      alert(`Failed to enroll: ${error.response?.data || error.message || \"Unknown error\"}`);\n    }\n  }\n\n  if (loading) {\n    return (\n      <div className=\"loading-spinner\">\n        <div className=\"spinner-border text-primary\" role=\"status\">\n          <span className=\"visually-hidden\">Loading courses...</span>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <Container className=\"py-5\">\n      <Row className=\"mb-4\">\n        <Col>\n          <h1 className=\"display-4 fw-bold text-center mb-4\">All Courses</h1>\n          <p className=\"lead text-center text-muted mb-4\">Discover and enroll in courses that match your interests</p>\n\n          {/* Search Bar */}\n          <Row className=\"justify-content-center\">\n            <Col md={6}>\n              <InputGroup className=\"mb-4\">\n                <Form.Control\n                  type=\"text\"\n                  placeholder=\"Search courses...\"\n                  value={searchTerm}\n                  onChange={(e) => setSearchTerm(e.target.value)}\n                />\n                <Button variant=\"outline-primary\">\n                  <i className=\"bi bi-search\"></i>\n                </Button>\n              </InputGroup>\n            </Col>\n          </Row>\n        </Col>\n      </Row>\n\n      <Row>\n        {filteredCourses.length === 0 ? (\n          <Col>\n            <Card className=\"text-center py-5\">\n              <Card.Body>\n                <h5>No Courses Found</h5>\n                <p className=\"text-muted\">\n                  {searchTerm ? \"Try adjusting your search terms.\" : \"No courses are available at the moment.\"}\n                </p>\n              </Card.Body>\n            </Card>\n          </Col>\n        ) : (\n          filteredCourses.map((course) => (\n            <Col md={6} lg={4} key={course.courseId} className=\"mb-4\">\n              <Card className=\"course-card h-100\">\n                {course.mediaUrl ? (\n                  <Card.Img\n                    variant=\"top\"\n                    src={course.mediaUrl}\n                    style={{ height: \"200px\", objectFit: \"cover\" }}\n                  />\n                ) : (\n                  <div className=\"card-img-top course-gradient-bg\">\n                    {course.title}\n                  </div>\n                )}\n                <Card.Body className=\"d-flex flex-column\">\n                  <Card.Title>{course.title}</Card.Title>\n                  <Card.Text className=\"flex-grow-1\">{course.description}</Card.Text>\n                  <div className=\"mt-auto\">\n                    <div className=\"d-flex justify-content-between align-items-center mb-2\">\n                      <small className=\"text-muted\">Instructor: {course.instructorName || \"TBA\"}</small>\n                      <small className=\"text-muted\">{course.enrolledStudents || 0} students</small>\n                    </div>\n                    <div className=\"d-flex gap-2\">\n                      <Link to={`/course/${course.courseId}`}>\n                        <Button variant=\"outline-primary\" size=\"sm\">\n                          View Details\n                        </Button>\n                      </Link>\n                      {user && user.role === \"Student\" && (\n                        <Button\n                          variant=\"primary\"\n                          size=\"sm\"\n                          onClick={() => handleEnroll(course.courseId)}\n                          disabled={course.isEnrolled}\n                        >\n                          {course.isEnrolled ? \"Enrolled\" : \"Enroll Now\"}\n                        </Button>\n                      )}\n                    </div>\n                  </div>\n                </Card.Body>\n              </Card>\n            </Col>\n          ))\n        )}\n      </Row>\n    </Container>\n  )\n}\n\nexport default CoursesPage\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}